{% load static %}

<style>
    
    .nav-link-custom {
        white-space: nowrap;
        padding: 8px 16px;
        margin-bottom: 5px; 
    }


@media (max-width: 768px) {
    .nav-link-custom {
        font-size: 0.9rem;
        padding: 6px 12px;
    }
}
    .logo-container {
        text-align: center;
        margin-bottom: 1rem;
    }


.btn-responsive-width {
    width: 100%;           
    display: block;         
    text-align: center;
}

@media (min-width: 768px) {
    .btn-responsive-width {
        width: auto !important;  
        display: inline-block;   
        min-width: 100px;        
    }
}


.nav-link-custom {
    white-space: nowrap;
    padding: 8px 16px;
    margin-bottom: 5px;
    transition: all 0.3s ease;
    
    
    color: var(--cat-color, #333); 
    border: 1px solid var(--cat-color, #ccc);
    background-color: transparent;
    border-radius: 5px;
    text-decoration: none;
}


.nav-link-custom:hover {
    background-color: var(--cat-color, #333);
    color: white !important;
}


.nav-link-custom.active {
    background-color: var(--cat-color, #333);
    color: white !important;
}
</style>

<div class="container header-container">
    <div class="row align-items-center mb-4">

        <!-- LOGO -->
        <div class="col-12 col-md-4 logo-container text-center text-md-start">
            <a href="{% url 'core:index' %}" class="text-decoration-none">
                <img src="{% static 'public/logo1.png' %}" alt="Resistencia Viva Logo"
                     style="max-height: 80px; width: auto;">
            </a>
        </div>

        <!-- BUSCADOR + LOGIN/LOGOUT + CREAR POST -->
        <div class="col-12 col-md-8 d-flex flex-column flex-md-row justify-content-center justify-content-md-end align-items-center gap-3">

            <!-- BUSCADOR -->
            <form action="{% url 'core:index' %}" method="GET"
                  style="position: relative; width: 100%; max-width: 300px;">
                <input type="text" name="q" class="form-control search-input"
                       placeholder="" value="{{ request.GET.q|default:'' }}">
                <button type="submit" class="search-btn">
                    <i class="bi bi-search text-dark"></i>
                </button>
            </form>

            {% if user.is_authenticated %}

                <!-- CREAR POST (MOVIDO ARRIBA) -->
                <a href="{% url 'post:nuevo_articulo' %}"
                   class="btn btn-responsive-width"
                   style="background-color: var(--accent-orange); color: white; font-weight: bold; padding: 8px 16px; border-radius: 2px;">
                    ➕ Crear post
                </a>

                <!-- LOGOUT -->
                <form action="{% url 'user:logout' %}" method="post" class="btn-responsive-width">
                    {% csrf_token %}
                    <button type="submit" class="btn-login-header w-100">LOGOUT</button>
                </form>

            {% else %}

                <!-- LOGIN -->
                <a href="{% url 'user:login' %}" class="btn-login-header btn-responsive-width">Login</a>

            {% endif %}
        </div>
    </div>
</div>
{% if request.path == '/' %}
<div class="row">
    <div class="col-12 d-flex flex-wrap justify-content-center justify-content-md-end align-items-center nav-links gap-2">
        
        {% for categoria in categorias %}
            <a href="?categoria={{ categoria.id }}" 
               class="nav-link-custom {% if request.GET.categoria == categoria.id|stringformat:'s' %}active{% endif %}"
               style="--cat-color: {{ categoria.color }};">
                {{ categoria.nombre }}
            </a>
        {% endfor %}

    <!-- CATEGORÍAS -->
    <div class="row">
        <div class="col-12 d-flex flex-wrap justify-content-center justify-content-md-end align-items-center nav-links gap-2">

            {% for categoria in categorias %}
                <a href="{% url 'post:categoria' categoria.slug %}" class="nav-link-custom">
                    {{ categoria.nombre }}
                </a>
            {% endfor %}

        </div>
    </div>
</div>
